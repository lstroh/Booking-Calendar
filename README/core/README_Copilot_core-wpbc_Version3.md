# Detailed Review: `core/wpbc.php` (Booking Calendar Plugin)

## Overview
`core/wpbc.php` contains the main logic for initializing and running the Booking Calendar plugin.  
It implements a singleton class `Booking_Calendar` that sets up all plugin features, menus, cron jobs, front-end and back-end resources, and manages compatibility and activation errors.

---

## Key Components

### 1. Security and Compatibility
- Prevents direct access outside WordPress with `if ( ! defined( 'ABSPATH' ) ) exit;`.
- Checks if WordPress version meets minimum requirements.

### 2. Singleton Class: `Booking_Calendar`
- Ensures only one instance of the class can exist (`self::$instance`).
- Provides a static `init()` method to initialize the plugin and return the instance.

#### Main Properties
- `$cron`: Manages scheduled tasks.
- `$notice`: Handles admin notices.
- `$booking_obj`: Core booking functionality.
- `$admin_menu`: Stores menu objects.
- `$js` and `$css`: Handles JavaScript and CSS resources.

#### Initialization Steps
- Loads includes and version info.
- Registers hooks for WordPress initialization.
- Instantiates installer if needed.
- Calls `start()` to initialize booking objects, AJAX handlers, and cron jobs.

### 3. Menu Definition
- Dynamically creates admin menu items (Bookings, Add Booking, Availability, Prices, Resources, Settings, Setup Wizard, Log Off Simulated User).
- Uses role-based access and displays update badges for new bookings.

### 4. Resource Loading
- Loads supporting files via includes (`includes/wpbc-include.php`).
- Sets up CSS and JS loading for both admin and front-end.
- Handles AJAX requests by loading AJAX responder and booking class.

### 5. Error Handling
- If the plugin is not compatible or another instance is active, displays appropriate admin error notices about minimum WP version or existing plugin activation.

### 6. Utility and Debugging
- Provides utility functions, such as getting menu objects and showing debug/info output in the admin footer.
- Prevents cloning and unserializing the singleton class to avoid multiple instances.

### 7. Bootstrapping
- The global function `WPBC()` returns the singleton instance and starts the plugin.
- Calls `WPBC()` to start up when the file loads.

---

## Purpose
`core/wpbc.php` is the central controller for the Booking Calendar plugin, managing initialization, admin menus, compatibility, AJAX, cron, and resource loading.  
It ensures only one plugin instance runs and provides error messaging if requirements arenâ€™t met.

---

## Next Steps
To further explore the plugin:
- Review `/includes/wpbc-include.php` for included features.
- Examine menu class implementations (e.g., `WPBC_Admin_Menus`) for admin UI details.
- Check front-end and AJAX logic for booking workflows.

---

*Generated by Copilot for repository @lstroh/Booking-Calendar*